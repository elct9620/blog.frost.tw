<!doctype html><html lang=en><head><title>Build a Form Helper capable Form Object in Rails - Aotokitsuruya is learning</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="The Form Object is a common pattern in Rails when our form becomes complex. But the tutorial in network&amp;rsquo;s example usually incapable of Rails' form helper.
And I …
"><meta name=created content="2020-05-03T00:00:00+0000"><meta name=modified content="2020-05-03T16:29:36+0800"><meta name=author content="蒼時弦也"><meta property="og:site_name" content="Aotokitsuruya is learning"><meta property="og:title" content="Build a Form Helper capable Form Object in Rails"><meta property="og:url" content="https://blog.frost.tw/en/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.frost.tw/images/2020-05-03-build-a-form-helper-capable-form-object-in-rails/thumbnail.jpg"><meta name=theme-color content="#EFEFEF"><link href=https://blog.frost.tw/icon-512.png rel=icon><link rel=canonical href=https://blog.frost.tw/en/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/><link rel=alternate hreflang=zh-tw href=https://blog.frost.tw/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/><script type=application/ld+json>[{"@context":"https://schema.org","@type":"WebPage","headline":"Build a Form Helper capable Form Object in Rails","datePublished":"2020-05-03T16:29:36+08:00","dateModified":"2020-05-03T16:29:36+08:00","url":"https://blog.frost.tw/en/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/","description":"The Form Object is a common pattern in Rails when our form becomes complex. But the tutorial in network\u0026rsquo;s example usually incapable of Rails' form helper.\nAnd I …\n","keywords":["Rails","Ruby","Ruby on Rails","Experience"],"image":"https://blog.frost.tw/images/2020-05-03-build-a-form-helper-capable-form-object-in-rails/thumbnail.jpg","author":{"@type":"Person","name":"蒼時弦也"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.frost.tw/"},"publisher":{"@type":"Organization","name":"Aotokitsuruya is learning","url":"https://blog.frost.tw/"}},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://blog.frost.tw/","name":"Aotokitsuruya is learning","image":"http://blog.frost.tw/icon-512.png"}},{"@type":"ListItem","position":2,"item":{"@id":"https://blog.frost.tw/en/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/","name":"Build a Form Helper capable Form Object in Rails","image":"https://blog.frost.tw/images/2020-05-03-build-a-form-helper-capable-form-object-in-rails/thumbnail.jpg"}}]}]</script><script async src=/js/turbolinks.min.js></script></head><body><div id=fb-root data-turbolinks-permanent></div><h1 id=sitename><a href=/en class="hide-text logo--icon align-center">Aotokitsuruya is learning</a></h1><aside id=slogan class="slogan align-center text-center"><h2 class=slogan__title>Aotokitsuruya</h2><p class=slogan__description>The Web is attracting me, so I start learning PHP, HTML, CSS and JavaScript. When I know about Ruby, I fall in love with it. Now, I working with my friend to design games using C++ and still learning web about Golang, Ruby and JavaScript. In the other side, I also be a designer, the reason why the web is attracted me.</p></aside><div id=wrapper><article class="post article" role=article><header class=article__header><time datetime=2020-05-03T16:29:36+0800 class=article__time--header>May.03</time><h1 class=article__title>Build a Form Helper capable Form Object in Rails</h1></header><div class=article__entry><nav class=translation><a class=translation__link href=https://blog.frost.tw/posts/2020/05/03/Build-a-Form-Helper-capable-Form-Object-in-Rails/>繁體中文</a></nav><aside class=article__toc><header class=article__toc-title><h3>Table of Contents</h3></header><nav class=article__toc-list role=list><nav id=TableOfContents><ul><li><a href=#common-form-object-implementation>Common Form Object Implementation</a></li><li><a href=#the-form-helper>The Form Helper</a></li><li><a href=#the-persisted>The persisted?</a></li><li><a href=#the-to_param-and-model_name>The to_param and model_name</a></li><li><a href=#load-attributes>Load Attributes</a></li><li><a href=#future-improve>Future Improve</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></nav><hr></aside><p>The Form Object is a common pattern in Rails when our form becomes complex. But the tutorial in network&rsquo;s example usually incapable of Rails' form helper.</p><p>And I start thinking about is it possible to support form helpers without too many changes?</p><h2 id=common-form-object-implementation>Common Form Object Implementation</h2><p>To improve our form object, we have to know about the original version we are using.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=k>class</span> <span class=nc>RegistrationForm</span>
  <span class=kp>include</span> <span class=no>ActiveModel</span><span class=o>::</span><span class=no>Model</span>
  <span class=kp>include</span> <span class=no>ActiveModel</span><span class=o>::</span><span class=no>Validations</span>

  <span class=kp>attr_accessor</span> <span class=ss>:email</span><span class=p>,</span> <span class=ss>:password</span><span class=p>,</span> <span class=ss>:password_confirmation</span>

  <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>user</span><span class=p>,</span> <span class=n>params</span> <span class=o>=</span> <span class=p>{})</span>
    <span class=vi>@user</span> <span class=o>=</span> <span class=n>user</span>
    <span class=k>super</span> <span class=n>params</span>
  <span class=k>end</span>

  <span class=c1># ...</span>

  <span class=k>def</span> <span class=nf>attributes</span>
    <span class=p>{</span>
      <span class=ss>email</span><span class=p>:</span> <span class=vi>@email</span><span class=p>,</span>
      <span class=ss>password</span><span class=p>:</span> <span class=vi>@password</span>
    <span class=p>}</span>
  <span class=k>end</span>

  <span class=k>def</span> <span class=nf>save</span>
    <span class=k>return</span> <span class=k>unless</span> <span class=n>valid?</span>

    <span class=vi>@user</span><span class=o>.</span><span class=n>assign_attributes</span><span class=p>(</span><span class=n>attributes</span><span class=p>)</span>
    <span class=vi>@user</span><span class=o>.</span><span class=n>save</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><p>This is a common form object you can find in the network, it gives us model-like behavior which can use it in the controller without too many changes.</p><p>But in the view, our form helper has to set method and URL at any time.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=o>&lt;%=</span> <span class=n>form_for</span> <span class=vi>@form</span><span class=p>,</span> <span class=nb>method</span><span class=p>:</span> <span class=ss>:post</span><span class=p>,</span> <span class=ss>url</span><span class=p>:</span> <span class=n>users_path</span> <span class=k>do</span> <span class=o>|</span><span class=n>f</span><span class=o>|</span> <span class=s>%&gt;
</span><span class=s>&lt;% # ... %&gt;</span>
<span class=o>&lt;</span><span class=sx>% end </span> <span class=o>%&gt;</span>
</code></pre></td></tr></table></div></div><h2 id=the-form-helper>The Form Helper</h2><p>To improve the form object, I starting review the source code of form helper.</p><p>In the <a href=https://github.com/rails/rails/blob/bdc581616b760d1e2be3795c6f0f3ab4b1e125a5/actionview/lib/action_view/helpers/form_helper.rb#L440>action_view/helpers/form_helper.rb#L440</a>, the ActiveView will try to <code>apply_form_for_options!</code> if we give a object for it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=n>apply_form_for_options!</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=n>object</span><span class=p>,</span> <span class=n>options</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>In the <a href=https://github.com/rails/rails/blob/bdc581616b760d1e2be3795c6f0f3ab4b1e125a5/actionview/lib/action_view/helpers/form_helper.rb#L457-L474><code>apply_form_for_options!</code></a> method, we can find it set the <code>method</code> and <code>url</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=n>action</span><span class=p>,</span> <span class=nb>method</span> <span class=o>=</span> <span class=n>object</span><span class=o>.</span><span class=n>respond_to?</span><span class=p>(</span><span class=ss>:persisted?</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=n>object</span><span class=o>.</span><span class=n>persisted?</span> <span class=p>?</span> <span class=o>[</span><span class=ss>:edit</span><span class=p>,</span> <span class=ss>:patch</span><span class=o>]</span> <span class=p>:</span> <span class=o>[</span><span class=ss>:new</span><span class=p>,</span> <span class=ss>:post</span><span class=o>]</span>
<span class=c1># ...</span>
<span class=n>options</span><span class=o>[</span><span class=ss>:url</span><span class=o>]</span> <span class=o>||=</span> <span class=k>if</span> <span class=n>options</span><span class=o>.</span><span class=n>key?</span><span class=p>(</span><span class=ss>:format</span><span class=p>)</span>
  <span class=n>polymorphic_path</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=nb>format</span><span class=p>:</span> <span class=n>options</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=ss>:format</span><span class=p>))</span>
<span class=k>else</span>
  <span class=n>polymorphic_path</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=p>{})</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><p>That means if our form object can provide the same interface to the form helper, it will correctly configure the form&rsquo;s method and URL without extra work.</p><h2 id=the-persisted>The persisted?</h2><p>When the form helper decides to use <code>POST</code> to create a new object or use <code>PUT</code> to update an existing object. It depends on the model&rsquo;s <code>persisted?</code> method.</p><p>That means we can add <code>persisted?</code> method to our form object to make form helper can detect it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=k>class</span> <span class=nc>BaseForm</span>
  <span class=c1># ...</span>

  <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=n>params</span> <span class=o>=</span> <span class=p>{})</span>
    <span class=vi>@record</span> <span class=o>=</span> <span class=n>record</span>
    <span class=k>super</span> <span class=n>params</span>
  <span class=k>end</span>

  <span class=k>def</span> <span class=nf>persisted?</span>
    <span class=vi>@record</span> <span class=o>&amp;&amp;</span> <span class=vi>@record</span><span class=o>.</span><span class=n>persisted?</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><p>But there has another better way to implement it, we can use <a href=https://api.rubyonrails.org/classes/Module.html#method-i-delegate><code>delegate</code></a> which provided by ActiveSupport.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=k>class</span> <span class=nc>BaseForm</span>
  <span class=c1># ...</span>

  <span class=n>delegate</span> <span class=ss>:persisted?</span><span class=p>,</span> <span class=ss>to</span><span class=p>:</span> <span class=ss>:@record</span><span class=p>,</span> <span class=ss>allow_nil</span><span class=p>:</span> <span class=kp>true</span>

  <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=n>params</span> <span class=o>=</span> <span class=p>{})</span>
    <span class=vi>@record</span> <span class=o>=</span> <span class=n>record</span>
    <span class=k>super</span> <span class=n>params</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><h2 id=the-to_param-and-model_name>The to_param and model_name</h2><p>The URL is generated by <a href=https://api.rubyonrails.org/classes/ActionDispatch/Routing/PolymorphicRoutes.html#method-i-polymorphic_path><code>polymorphic_path</code></a> and it uses <code>model_name</code> and <code>to_param</code> to generate the path.</p><p>We can try it in the Rails console:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>&gt; app.polymorphic_path<span class=o>(</span>User.new<span class=o>)</span>
<span class=o>=</span>&gt; <span class=s2>&#34;/users&#34;</span>
&gt; app.polymorphic_path<span class=o>(</span>User.last<span class=o>)</span>
<span class=o>=</span>&gt; <span class=s2>&#34;/users/1234&#34;</span>
</code></pre></td></tr></table></div></div><p>And when we add delegate <code>model_name</code> and <code>to_param</code> to our form object, we can get the same result.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=n>delegate</span> <span class=ss>:persisted?</span><span class=p>,</span> <span class=ss>:model_name</span><span class=p>,</span> <span class=ss>:to_param</span><span class=p>,</span> <span class=ss>to</span><span class=p>:</span> <span class=ss>:@record</span><span class=p>,</span> <span class=ss>allow_nil</span><span class=p>:</span> <span class=kp>true</span>
</code></pre></td></tr></table></div></div><p>And check it again:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>&gt; app.polymorphic_path<span class=o>(</span>RegistrationForm.new<span class=o>(</span>User.new<span class=o>))</span>
<span class=o>=</span>&gt; <span class=s2>&#34;/users&#34;</span>
&gt; app.polymorphic_path<span class=o>(</span>RegistrationForm.new<span class=o>(</span>User.last<span class=o>))</span>
<span class=o>=</span>&gt; <span class=s2>&#34;/users/1234&#34;</span>
</code></pre></td></tr></table></div></div><p>For now, we have the same interface as the model.</p><h2 id=load-attributes>Load Attributes</h2><p>Since we can let form helper work correctly but we still cannot load the data when we edit an existing model.</p><p>To resolve it, we can adjust our initialize method to retrieve the necessary fields.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=k>class</span> <span class=nc>RegistrationForm</span> <span class=o>&lt;</span> <span class=no>BaseForm</span>
  <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=n>params</span> <span class=o>=</span> <span class=p>{})</span>
    <span class=n>attributes</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>slice</span><span class=p>(</span><span class=ss>:email</span><span class=p>,</span> <span class=ss>:password</span><span class=p>)</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
    <span class=k>super</span> <span class=n>record</span><span class=p>,</span> <span class=n>params</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><p>Another way is to use Attribute API to support it, but we have to exactly define each attribute in our form object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=k>class</span> <span class=nc>BaseForm</span>
  <span class=c1># ...</span>
  <span class=kp>include</span> <span class=no>ActiveModel</span><span class=o>::</span><span class=no>Attributes</span>

  <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=n>params</span> <span class=o>=</span> <span class=p>{})</span>
    <span class=vi>@record</span> <span class=o>=</span> <span class=n>record</span>
    <span class=n>attributes</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>attributes</span><span class=o>.</span><span class=n>slice</span><span class=p>(</span><span class=o>*.</span><span class=n>self</span><span class=o>.</span><span class=n>class</span><span class=o>.</span><span class=n>attribute_names</span><span class=p>)</span>
    <span class=k>super</span> <span class=n>attributes</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
  <span class=k>end</span>
<span class=k>end</span>

<span class=c1># app/forms/registration_form.rb</span>
<span class=k>class</span> <span class=nc>RegistrationForm</span> <span class=o>&lt;</span> <span class=no>BaseForm</span>
  <span class=n>attribute</span> <span class=ss>:email</span><span class=p>,</span> <span class=ss>:string</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><blockquote><p>But we have to take care the <code>params</code> hash, the model return attributes is <code>{"name" => "Joy"}</code> but we use <code>{name: "Joy"}</code> we will get the hash mixed string and symbol keys <code>{"name" => "Joy", name: "Joy"}</code> and didn&rsquo;t set the attribute to our form object.</p></blockquote><h2 id=future-improve>Future Improve</h2><p>In the current version, we have to pass the model instance to the form object. Maybe we can add some DSL to auto-create it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=c1># Option 1</span>
<span class=k>class</span> <span class=nc>RegistrationForm</span> <span class=o>&lt;</span> <span class=no>BaseForm</span>
  <span class=n>model_class</span> <span class=s1>&#39;User&#39;</span>

  <span class=n>attribute</span> <span class=ss>:name</span>
<span class=k>end</span>

<span class=c1># Option 2</span>
<span class=k>class</span> <span class=nc>RegistrationForm</span> <span class=o>&lt;</span> <span class=no>BaseForm</span><span class=o>[</span><span class=no>User</span><span class=o>]</span>
  <span class=n>attribute</span> <span class=ss>:name</span>
<span class=k>end</span>
</code></pre></td></tr></table></div></div><p>But we also need to consider this way may not a good idea in some complex system.</p><p>For example, we had load the <code>User</code> from a controller or other object. But we cannot pass it to the form object. That means our form object usually loads the object when we access it.
If we have nested form it will cause the N+1 query in this case.</p><p>This is another topic when we use the form object or service object to refactor our code. We may reduce the duplicate code but cause our system to slow down or new hidden bug we didn&rsquo;t know about it.</p><h2 id=conclusion>Conclusion</h2><p>I didn&rsquo;t have many experiences to use the form object. But I think it is a common case when we build an application.
This version form object still has a lot of limitation and I didn&rsquo;t consider all possible use cases.</p><p>I will try to improve it in my future works and keep it as a simple object if possible. I believe we didn&rsquo;t always need to build a complex behavior and add a gem to resolve some simple things.</p><footer class=article__footer><div class=text-center><div class=fb-share-button data-href="<%- page.permalink %>" data-layout=button_count></div></div><div class="text-center mt-1"><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:36px!important;height:37px!important;text-decoration:none!important;display:inline-flex!important;color:#fff!important;background-color:#000!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#fff!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie&display=swap" rel=stylesheet><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/aotoki><img src=https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg rel=noreferrer alt="Buy me a Coffee"><span style=margin-left:5px>Buy me a Coffee</span></a></div><iframe title=LikeCoin scrolling=no frameborder=0 style="display:block;margin:0 auto;height:212px" src="https://button.like.co/in/embed/elct9620/button?referrer=<%- page.permalink %>"></iframe><ul class=article__tag-list><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/en/tags/Rails/>Rails</a></li><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/en/tags/Ruby/>Ruby</a></li><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/en/tags/Experience/>Experience</a></li></ul></footer><aside class=related><header class=related__header><h3 class=related__title>See Also</h3></header><ul><li class=related__item><a class=related__link href=/en/posts/2020/02/29/The-Reusable-Ansible-Role-Problem/>The Reusable Ansible Role Problem</a></li><li class=related__item><a class=related__link href=/en/posts/2020/02/20/Write-a-suitable-RSpec-test/>Write a suitable RSpec test</a></li><li class=related__item><a class=related__link href=/en/posts/2020/04/28/Review-the-Rails-Autoloading-and-Reloading/>Review the Rails' Autoloading and Reloading</a></li><li class=related__item><a class=related__link href=/en/posts/2020/04/03/TGONext-Database-Migration-and-Architecture-Changing/>TGONext: Database Migration and Architecture Changing</a></li><li class=related__item><a class=related__link href=/en/posts/2020/03/15/TGONext-Choose-Architecture-by-Cons/>TGONext: Choose Architecture By Cons</a></li></ul></aside></div></article><div class=subscribe><div id=mc_embed_signup><form action="https://frost.us4.list-manage.com/subscribe/post?u=dd3d68032c0510041f1302539&id=d2a668a8aa" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div id=mc_embed_signup_scroll><h1 class=subscribe__title>Newsletter</h2><div class=mc-field-group><input type=email name=EMAIL class="required email subscribe__input" id=mce-EMAIL placeholder=Email></div><div id=mce-responses class=clear><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_dd3d68032c0510041f1302539_d2a668a8aa tabindex=-1></div><div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class="button subscribe__button"></div></div></form></div></div><div class=adv><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-2844969736316510 data-ad-slot=5530952976 data-ad-format=auto></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><section id=comment class=comment-box><h1 class=comment-box__title>Comments</h1><div id=disqus_thread></div></div></section></div><footer id=footer><div id=copyright>&copy;2021 <a href="https://plus.google.com/117236344655673213049?rel=author" target=_blank rel=noreferrer>蒼時弦也</a>. All right reversed.</div></footer><link rel=stylesheet href=/css/styles.css><script src=/js/app.min.c2ee95eb1af6682877e13dd5ff8809b3eda43102f2446e2a2be672d7d7acfb08.js></script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5TQLRN" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='//www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-5TQLRN')</script><script>window.fbAsyncInit=function(){FB.init({appId:'178355449110',xfbml:!0,version:'v2.12'}),FB.AppEvents.logPageView()},function(b,c,d){var a,e=b.getElementsByTagName(c)[0];if(b.getElementById(d))return;a=b.createElement(c),a.id=d,a.src="https://connect.facebook.net/zh_TW/sdk.js",a.async=!0,a.defer=!0,e.parentNode.insertBefore(a,e)}(document,'script','facebook-jssdk')</script><div class=loading></div></body></html>