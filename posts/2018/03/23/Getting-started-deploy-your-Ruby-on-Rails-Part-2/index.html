<!doctype html><html lang=zh-tw><head><title>部署你的第一個 Ruby on Rails 網站（二） - 弦而時習之</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="延續上一篇文章的內容，我們需要先在伺服器上進行設定，讓伺服器可以正確的安裝 Ruby 環境。如此一來，我們才能夠將 Ruby on Rails 部署到伺服器上面。
為了完成這些前置作業，我們還需要針對伺服器的設定進行完善的準備才行。"><meta name=created content="2018-03-23T00:00:00+0000"><meta name=modified content="2018-03-23T09:15:32+0000"><meta name=author content="蒼時弦也"><meta property="og:site_name" content="弦而時習之"><meta property="og:title" content="部署你的第一個 Ruby on Rails 網站（二）"><meta property="og:url" content="https://blog.frost.tw/posts/2018/03/23/Getting-started-deploy-your-Ruby-on-Rails-Part-2/"><meta property="og:type" content="article"><meta name=theme-color content="#EFEFEF"><link rel=canonical href=https://blog.frost.tw/posts/2018/03/23/Getting-started-deploy-your-Ruby-on-Rails-Part-2/><script type=application/ld+json>[{"@context":"https://schema.org","@type":"WebPage","headline":"部署你的第一個 Ruby on Rails 網站（二）","datePublished":"2018-03-23T00:00:00Z","dateModified":"2018-03-23T09:15:32Z","url":"https://blog.frost.tw/posts/2018/03/23/Getting-started-deploy-your-Ruby-on-Rails-Part-2/","description":"延續上一篇文章的內容，我們需要先在伺服器上進行設定，讓伺服器可以正確的安裝 Ruby 環境。如此一來，我們才能夠將 Ruby on Rails 部署到伺服器上面。\n為了完成這些前置作業，我們還需要針對伺服器的設定進行完善的準備才行。\n","keywords":["教學","DevOps","Ruby on Rails"],"author":{"@type":"Person","name":"蒼時弦也"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.frost.tw/"},"publisher":{"@type":"Organization","name":"弦而時習之","url":"https://blog.frost.tw/"}},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/blog.frost.tw\/","name":"弦而時習之","image":"http:\/\/blog.frost.tw\/icon-512.png"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/blog.frost.tw\/posts\/2018\/03\/23\/Getting-started-deploy-your-Ruby-on-Rails-Part-2\/","name":"部署你的第一個 Ruby on Rails 網站（二）"}}]}]</script><link rel=stylesheet href=/css/styls.css><script async src=/js/turbolinks.min.js></script></head><body><div id=fb-root data-turbolinks-permanent></div><h1 id=sitename><a href=/ class="hide-text logo--icon align-center">弦而時習之</a></h1><aside id=slogan class="slogan align-center text-center"><h2 class=slogan__title>Aotokitsuruya</h2><p class=slogan__description>The Web is attracting me, so I start learning PHP, HTML, CSS and JavaScript. When I know about Ruby, I fall in love with it. Now, I working with my friend to design games using C++ and still learning web about Golang, Ruby and JavaScript. In the other side, I also be a designer, the reason why the web is attracted me.</p></aside><div id=wrapper><article class="post article"><header class=article__header><time datetime=2018-03-23T09:15:32+0000 class=article__time--header>Feb.23</time><h1 class=article__title>部署你的第一個 Ruby on Rails 網站（二）</h1></header><div class=article__entry><nav class=translation></nav><p>延續<a href=https://blog.frost.tw/posts/2018/03/20/Getting-started-deploy-your-Ruby-on-Rails-Part-1/>上一篇</a>文章的內容，我們需要先在伺服器上進行設定，讓伺服器可以正確的安裝 Ruby 環境。如此一來，我們才能夠將 Ruby on Rails 部署到伺服器上面。</p><p>為了完成這些前置作業，我們還需要針對伺服器的設定進行完善的準備才行。</p><h2 id=無密碼使用-sudo>無密碼使用 Sudo</h2><p>在完成上一篇的操作後，大家可能會發現用自己的帳號登入伺服器後，使用 <code>sudo</code> 指令是需要輸入密碼的。但是我們再新增使用者的時候，並沒有對這個帳號設定密碼，也因此無法使用。</p><p>一般來說，我們會選擇：</p><ul><li>設定密碼</li><li>讓沒有密碼也可以做 <code>sudo</code></li></ul><p>如果想要設定密碼，我們可以先用 <code>root</code> 連線到伺服器，使用下面的指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>passwd elct9620
</code></pre></td></tr></table></div></div><p>透過 <code>passwd</code> (Password) 指令，針對 <code>elct9620</code> 這個使用者進行密碼設定，如此一來就可以使用密碼來進行 <code>sudo</code> 的動作。</p><p>如果想要使用無密碼的模式，我們可以讓所有屬於 <code>wheel</code> 這個群組的使用者賦予 <code>NOPASSWD</code> 的設定，讓所有指令都可以在不輸入密碼的狀態下使用。</p><p>我們會需要用 Vim 模式進入 <code>sudo</code> 設定</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>visudo
</code></pre></td></tr></table></div></div><p>找下面這行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># %wheel  ALL=(ALL)       NOPASSWD: ALL</span>
</code></pre></td></tr></table></div></div><p>對 <code>#</code> 按 <code>x</code>（Delete）鍵再連續按下 <code>:wq</code> 存檔，就可以把註解刪掉，讓 <code>NOPASSWD</code> 的設定被啟用。</p><p>接下來用自己的帳號 SSH 到伺服器，就可以利用 <code>sudo</code> 下達任何指令，而不需要輸入密碼。</p><blockquote><p>為什麼不直接在 <code>root</code> 狀態下管理，主要是因為使用 <code>sudo</code> 指令可以提醒我們現在做的操作會「影響系統」，同樣的道理也可以適用在關閉密碼確認這件事情上。如何方便的管理伺服器，又不失安全性是作為一名伺服器管理員需要仔細考慮的事情。</p></blockquote><h2 id=安裝套件>安裝套件</h2><p>在 Linux 中，沒有任何 GUI（圖形介面）的情況下該如何安裝軟體呢？那就要透過 Linux 的套件管理程式，這跟我們平常使用的 <code>gem</code> 指令類似。如果是使用 Mac 的話也許會用過 Homebrew 來幫忙安裝開發環境，簡單說就是「幫忙安裝軟體」的工具。</p><p>在不同的 Linux 作業系統中，用來安裝套件的工具也有所差異，以下簡單列出幾種我知道的類型。</p><ul><li>RedHat / CentOS / Fedora - <code>yum</code></li><li>Debian / Ubuntu - <code>apt</code>(<code>apt-get</code>)</li><li>Arch Linux - <code>pacman</code></li></ul><p>不同的套件管理工具有不一樣的指令，類似於我們用 <code>gem</code> 和 <code>npm</code> 會有一些指令上的差距一樣，這系列文章使用的 CentOS 是採用 <code>yum</code> 來安裝。不過就使用上的容易程度來說，其實 <code>apt-get</code> 算是比較簡單的，不過這些安裝指令在網路上其實都能找到，即使忘記怎麼使用只要善用 Google 也還是能很快的瞭解怎麼使用。</p><p>為了要能夠在伺服器上運行 Ruby 我們除了可以透過 <code>yum</code> 安裝之外，也能夠自行下載 Ruby 的原始碼來編譯。不同的做法有不同的優缺點，以這次的計畫，我們希望能夠自行管理 Ruby 版本。所以採取自行編譯 Ruby 原始碼的方式來安裝環境，因此我們需要先有可以編譯 Ruby 環境的套件。</p><p>參考 <a href=https://github.com/rbenv/ruby-build/wiki>rbenv/ruby-build</a> 上面的說明，我們可以透過下面的指令簡單地將編譯 Ruby 所需套件找出來。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>yum install -y gcc bzip2 openssl-devel libyaml-devel libffi-devel readline-devel zlib-devel gdbm-devel ncurses-devel
</code></pre></td></tr></table></div></div><p>上述安裝的 <code>gcc</code> 套件是用來編譯的，而 <code>-devel</code> 結尾的套件是讓程式「編譯」的時候能夠找到原始碼資訊的對應資訊。</p><blockquote><p>一般安裝軟體的時候我們會希望儘可能節省空間，所以只會把 Binary（二進位可執行檔）的部分安裝進來。但是當我想要自行編譯某個程式的時候，就需要有一個參考去對應他的功能，而這些參考（ex. Header）就可以透過 <code>devel</code> 類型的套件來補足。</p></blockquote><p>當執行完成這個指令後，我們就算是準備好編譯 Ruby 了！</p><blockquote><p>如果你使用 AWS EC2 練習的話，上面的指令可能不會運作。因為 Amazon Linux 2 提供支援的 <code>gcc</code> 已經是 <code>gcc-7</code> 了！</p></blockquote><h2 id=小結>小結</h2><p>到目前為止，我們基本上算是將安裝伺服器的「前置動作」完成。下一篇文章就會正式的開始把 Ruby 和 Passenger 透過最簡單的方式進行手動編譯，將它安裝到我們的伺服器上。</p><p>如此一來，就算是擁有一個可以執行 Ruby 程式的伺服器了！</p><footer class=article__footer><div class=text-center><div class=fb-share-button data-href="<%- page.permalink %>" data-layout=button_count></div></div><div class="text-center mt-1"><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:36px!important;height:37px!important;text-decoration:none!important;display:inline-flex!important;color:#fff!important;background-color:#000!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#fff!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/aotoki><img src=https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg alt="Buy me a Coffee"><span style=margin-left:5px>Buy me a Coffee</span></a></div><iframe scrolling=no frameborder=0 style="display:block;margin:0 auto;height:212px" src="https://button.like.co/in/embed/elct9620/button?referrer=<%- page.permalink %>"></iframe><ul class=article__tag-list><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/tags/%E6%95%99%E5%AD%B8/>教學</a></li><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/tags/DevOps/>DevOps</a></li></ul></footer></div></article></div><footer id=footer><div id=copyright>&copy;2020 <a href="https://plus.google.com/117236344655673213049?rel=author" target=_blank>蒼時弦也</a>. All right reversed.</div></footer><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5TQLRN" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5TQLRN');</script><script>window.fbAsyncInit=function(){FB.init({appId:'178355449110',xfbml:true,version:'v2.12'});FB.AppEvents.logPageView();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="https://connect.facebook.net/zh_TW/sdk.js";js.async=true
fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><script src=/js/app.min.65872d06d2379c3fe1b6e9d0b82a4064f89173451c64ad1ddd5a263da2405f05.js></script><div class=loading></div></body></html>