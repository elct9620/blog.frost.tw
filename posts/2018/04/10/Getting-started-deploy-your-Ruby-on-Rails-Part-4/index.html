<!doctype html><html lang=zh-tw><head><title>部署你的第一個 Ruby on Rails 網站（四） - 弦而時習之</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="從第一篇到第二篇的說明，加上第三篇我想大家已經對編譯自己的環境稍為熟悉。
為了要可以用 Passenger 作為網站伺服器，我們需要自行編譯 Nginx 讓他可以使用 Passenger 模組。"><meta name=created content="2018-04-10T00:00:00+0000"><meta name=modified content="2018-04-10T16:54:22+0000"><meta name=author content="蒼時弦也"><meta property="og:site_name" content="弦而時習之"><meta property="og:title" content="部署你的第一個 Ruby on Rails 網站（四）"><meta property="og:url" content="https://blog.frost.tw/posts/2018/04/10/Getting-started-deploy-your-Ruby-on-Rails-Part-4/"><meta property="og:type" content="article"><meta name=theme-color content="#EFEFEF"><link rel=canonical href=https://blog.frost.tw/posts/2018/04/10/Getting-started-deploy-your-Ruby-on-Rails-Part-4/><script type=application/ld+json>[{"@context":"https://schema.org","@type":"WebPage","headline":"部署你的第一個 Ruby on Rails 網站（四）","datePublished":"2018-04-10T00:00:00Z","dateModified":"2018-04-10T16:54:22Z","url":"https://blog.frost.tw/posts/2018/04/10/Getting-started-deploy-your-Ruby-on-Rails-Part-4/","description":"從第一篇到第二篇的說明，加上第三篇我想大家已經對編譯自己的環境稍為熟悉。\n為了要可以用 Passenger 作為網站伺服器，我們需要自行編譯 Nginx 讓他可以使用 Passenger 模組。\n","keywords":["教學","DevOps","Ruby on Rails"],"author":{"@type":"Person","name":"蒼時弦也"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.frost.tw/"},"publisher":{"@type":"Organization","name":"弦而時習之","url":"https://blog.frost.tw/"}},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/blog.frost.tw\/","name":"弦而時習之","image":"http:\/\/blog.frost.tw\/icon-512.png"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/blog.frost.tw\/posts\/2018\/04\/10\/Getting-started-deploy-your-Ruby-on-Rails-Part-4\/","name":"部署你的第一個 Ruby on Rails 網站（四）"}}]}]</script><link rel=stylesheet href=/css/styls.css><script async src=/js/turbolinks.min.js></script></head><body><div id=fb-root data-turbolinks-permanent></div><h1 id=sitename><a href=/ class="hide-text logo--icon align-center">弦而時習之</a></h1><aside id=slogan class="slogan align-center text-center"><h2 class=slogan__title>Aotokitsuruya</h2><p class=slogan__description>The Web is attracting me, so I start learning PHP, HTML, CSS and JavaScript. When I know about Ruby, I fall in love with it. Now, I working with my friend to design games using C++ and still learning web about Golang, Ruby and JavaScript. In the other side, I also be a designer, the reason why the web is attracted me.</p></aside><div id=wrapper><article class="post article"><header class=article__header><time datetime=2018-04-10T16:54:22+0000 class=article__time--header>Feb.10</time><h1 class=article__title>部署你的第一個 Ruby on Rails 網站（四）</h1></header><div class=article__entry><nav class=translation></nav><p>從<a href=https://blog.frost.tw/posts/2018/03/20/Getting-started-deploy-your-Ruby-on-Rails-Part-1/>第一篇</a>到<a href=https://blog.frost.tw/posts/2018/03/23/Getting-started-deploy-your-Ruby-on-Rails-Part-2/>第二篇</a>的說明，加上<a href=https://blog.frost.tw/posts/2018/03/27/Getting-started-deploy-your-Ruby-on-Rails-Part-3/>第三篇</a>我想大家已經對編譯自己的環境稍為熟悉。</p><p>為了要可以用 Passenger 作為網站伺服器，我們需要自行編譯 Nginx 讓他可以使用 Passenger 模組。</p><p>不過因為 Passenger 已經針對這方面做好對應的處置，所以我們只需要按照 Passenger 提供的解決方案一步一步的進行編譯即可。</p><blockquote><p>Passenger 提供了從原始碼安裝跟透過 Ruby Gem 安裝兩種，為了好維護跟升級，這篇文章會採取從原始碼安裝的方式。</p></blockquote><h2 id=取得原始碼>取得原始碼</h2><p>Passenger 除了開放原始碼的版本，也有企業版。從<a href=https://www.phusionpassenger.com/>官網</a>可以找到開放原始碼版本的下載點，而且貼心的提供了像下面截圖的安裝指南。</p><p><img src=https://blog.frost.tw/images/getting-started-deploy-your-ruby-on-rails-part-4/screenshot1.jpg alt="螢幕快照 2018-04-10 上午12.13.04.png"></p><p>因為要從原始碼安裝，所以要先選擇其他作業系統。</p><p><img src=https://blog.frost.tw/images/getting-started-deploy-your-ruby-on-rails-part-4/screenshot2.jpg alt="螢幕快照 2018-04-10 上午12.13.30.png"></p><p>因為要和 Nginx 搭配，要記得將 <code>Standalone</code> 改為 <code>Nginx</code> 才能得到正確的安裝指南。</p><blockquote><p>不過 Standalone 模式似乎也會變編譯一個 Nginx 來運行，只是不會顯示給使用者。</p></blockquote><p>對頁面上的「Download tarball」按鈕點選右鍵複製連結，會得到類似下面的連結。</p><pre><code>https://www.phusionpassenger.com/latest_stable_tarball
</code></pre><p>因為 Passenger 不像 Ruby 安裝完畢後會複製到某個指定的資料夾，所以我們可以參考 Homebrew 的方式，在 <code>/usr/local/passenger</code> 裡面放置檔案。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>mkdir /usr/local/passenger
<span class=nb>cd</span> /usr/local/passenger
wget https://www.phusionpassenger.com/latest_stable_tarball
</code></pre></td></tr></table></div></div><blockquote><p>這邊建議用 <code>root</code> 來進行這個動作，因為 Passenger 安裝過程會需要 <code>root</code> 權限之外，<code>/usr/local</code> 目錄要新增資料夾也是需要有 <code>root</code> 權限的。</p></blockquote><h2 id=安裝-passenger>安裝 Passenger</h2><p>首先把我們下載回來的 Passenger 解壓縮。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>tar -zxvf latest_stable_tarball
</code></pre></td></tr></table></div></div><blockquote><p>用 <code>wget</code> 不知道原因並沒有自動轉成檔名，不過能夠解壓縮就就不需要太在意細節。</p></blockquote><p>解壓縮後應該會得到一個最新版的 Passenger 目錄（本文撰寫時是 5.2.3 版）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=o>[</span>root@deploy-example passenger<span class=o>]</span><span class=c1># ls</span>
latest_stable_tarball  passenger-5.2.3
</code></pre></td></tr></table></div></div><p>接著進入 <code>passenger-5.2.3</code> 這個目錄，執行 Passenger 的安裝程式。因為 Passenger 是有使用 Ruby 的，如果上一篇文章介紹的設定沒有正確的話，可能會無法執行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/usr/local/passenger/passenger-5.2.3/bin:<span class=nv>$PATH</span>
passenger-install-nginx-module
</code></pre></td></tr></table></div></div><p>依照文件，我們跟上次設定 Ruby 的時候一樣先暫時讓 Passenger 的執行檔都可以執行。安裝中途也會嘗試呼叫這個目錄的其他執行檔，所以在安裝階段先這樣設定會讓後續流暢不少。</p><blockquote><p>執行 <code>passenger-install-nginx-module</code> 會中斷好幾次，主要是 Passenger 會建議我們把一些設定改善後再繼續。</p></blockquote><p>開始後，會先出現類似下面的詢問訊息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=o>[</span>root@deploy-example passenger-5.2.3<span class=o>]</span><span class=c1># passenger-install-nginx-module</span>
Welcome to the Phusion Passenger Nginx module installer, v5.2.3.

This installer will guide you through the entire installation process. It
shouldn<span class=s1>&#39;t take more than 5 minutes in total.
</span><span class=s1>
</span><span class=s1>Here&#39;</span>s what you can expect from the installation process:

 1. This installer will compile and install Nginx with Passenger support.
 2. You<span class=s1>&#39;ll learn how to configure Passenger in Nginx.
</span><span class=s1> 3. You&#39;</span>ll learn how to deploy a Ruby on Rails application.

Don<span class=err>&#39;</span>t worry <span class=k>if</span> anything goes wrong. This installer will advise you on how to
solve any problems.

Press Enter to <span class=k>continue</span>, or Ctrl-C to abort.
</code></pre></td></tr></table></div></div><p>因為有好幾次詢問，所以如果後面沒有特別提醒的話，請自己按 Enter 繼續執行即可。</p><p>開始後會先詢問要支援哪些語言，因為 Passenger 後來陸續增加了 Python 和 Node.js 的支援，如果需要的話，也可以用方向鍵和空白鍵選取起來。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Which languages are you interested in?

Use &lt;space&gt; to <span class=k>select</span>.
If the menu doesn<span class=s1>&#39;t display correctly, press &#39;</span>!<span class=err>&#39;</span>

 ‣ ⬢  Ruby
   ⬡  Python
   ⬡  Node.js
   ⬡  Meteor
</code></pre></td></tr></table></div></div><p>下一步會檢查相依性，如果出現類似下面的訊息，就表示有缺少一些程式。按下 Enter 之後 Passenger 會給出安裝指令，我們再複製來使用即可。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Checking <span class=k>for</span> required software...

 * Checking <span class=k>for</span> C compiler...
      Found: yes
      Location: /usr/bin/cc
 * Checking <span class=k>for</span> C++ compiler...
      Found: no
 * Checking <span class=k>for</span> A download tool like <span class=s1>&#39;wget&#39;</span> or <span class=s1>&#39;curl&#39;</span>...
      Found: yes
      Location: /usr/bin/wget
 * Checking <span class=k>for</span> Curl development headers with SSL support...
      Found: no
      Error: Cannot find the <span class=sb>`</span>curl-config<span class=sb>`</span> command.
 * Checking <span class=k>for</span> OpenSSL development headers...
      Found: yes
      Location: /usr/include/openssl/ssl.h
 * Checking <span class=k>for</span> Zlib development headers...
      Found: yes
      Location: /usr/include/zlib.h
 * Checking <span class=k>for</span> Rake <span class=o>(</span>associated with /usr/local/ruby-2.4.3/bin/ruby<span class=o>)</span>...
      Found: yes
      Location: /usr/local/ruby-2.4.3/bin/ruby /usr/local/ruby-2.4.3/bin/rake
 * Checking <span class=k>for</span> OpenSSL support <span class=k>for</span> Ruby...
      Found: yes
 * Checking <span class=k>for</span> RubyGems...
      Found: yes
 * Checking <span class=k>for</span> Ruby development headers...
      Found: yes
      Location: /usr/local/ruby-2.4.3/include/ruby-2.4.0/ruby.h
 * Checking <span class=k>for</span> rack...
      Found: no

Some required software is not installed.
But don<span class=err>&#39;</span>t worry, this installer will tell you how to install them.
Press Enter to <span class=k>continue</span>, or Ctrl-C to abort.
</code></pre></td></tr></table></div></div><p>提示的安裝指令如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>--------------------------------------------

Installation instructions <span class=k>for</span> required software

 * To install C++ compiler:
   Please install it with yum install gcc-c++

 * To install Curl development headers with SSL support:
   Please install it with yum install libcurl-devel

 * To install rack:
   Please make sure RubyGems is installed, <span class=k>then</span> run /usr/local/ruby-2.4.3/bin/ruby /usr/local/ruby-2.4.3/bin/gem install rack

If the aforementioned instructions didn<span class=err>&#39;</span>t solve your problem, <span class=k>then</span> please take
a look at our documentation <span class=k>for</span> troubleshooting tips:

  https://www.phusionpassenger.com/library/install/nginx/
  https://www.phusionpassenger.com/library/admin/nginx/troubleshooting/
</code></pre></td></tr></table></div></div><p>既然缺少了，那們我們就先執行對應的指令將缺少的套件安裝完成。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>yum install gcc-c++ libcurl-devel
gem install rack
</code></pre></td></tr></table></div></div><p>完成之後，我們重新執行 <code>passenger-install-nginx-module</code> 指令，前面的檢查選項就可以通過。這時候就會詢問我們要自己將 Passenger 加入 Nginx 編譯，還是讓 Passenger 幫我們自動編譯 Nginx。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Automatically download and install Nginx?

Nginx doesn<span class=s1>&#39;t support loadable modules such as some other web servers do,
</span><span class=s1>so in order to install Nginx with Passenger support, it must be recompiled.
</span><span class=s1>
</span><span class=s1>Do you want this installer to download, compile and install Nginx for you?
</span><span class=s1>
</span><span class=s1> 1. Yes: download, compile and install Nginx for me. (recommended)
</span><span class=s1>    The easiest way to get started. A stock Nginx 1.12.2 with Passenger
</span><span class=s1>    support, but with no other additional third party modules, will be
</span><span class=s1>    installed for you to a directory of your choice.
</span><span class=s1>
</span><span class=s1> 2. No: I want to customize my Nginx installation. (for advanced users)
</span><span class=s1>    Choose this if you want to compile Nginx with more third party modules
</span><span class=s1>    besides Passenger, or if you need to pass additional options to Nginx&#39;</span>s
    <span class=s1>&#39;configure&#39;</span> script. This installer will  1<span class=o>)</span> ask you <span class=k>for</span> the location of
    the Nginx <span class=nb>source</span> code,  2<span class=o>)</span> run the <span class=s1>&#39;configure&#39;</span> script according to your
    instructions, and  3<span class=o>)</span> run <span class=s1>&#39;make install&#39;</span>.

Whichever you choose, <span class=k>if</span> you already have an existing Nginx configuration file,
<span class=k>then</span> it will be preserved.

Enter your choice <span class=o>(</span><span class=m>1</span> or 2<span class=o>)</span> or press Ctrl-C to abort: <span class=m>1</span>
</code></pre></td></tr></table></div></div><p>輸入 1 之後按下 Enter 就會開始把 Nginx 下載並且安裝摟！如果被詢問安裝目錄，基本上保持預設值就好，只是會跟透過 yum 安裝的位置不太一樣，所以要稍微記一下。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Where <span class=k>do</span> you want to install Nginx to?

Please specify a prefix directory <span class=o>[</span>/opt/nginx<span class=o>]</span>:
</code></pre></td></tr></table></div></div><blockquote><p>要注意的是如果選用的主機規格太小 Passenger 會建議換大一點的主機，至少要有 1G 以上的記憶體比較適合。</p></blockquote><p>如果中間都沒有出錯的話，我們會看到像下面這樣的訊息，也就表示安裝成功了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>Nginx with Passenger support was successfully installed.

The Nginx configuration file <span class=o>(</span>/opt/nginx/conf/nginx.conf<span class=o>)</span>
must contain the correct configuration options in order <span class=k>for</span> Phusion Passenger
to <span class=k>function</span> correctly.

This installer has already modified the configuration file <span class=k>for</span> you! The
following configuration snippet was inserted:

  http <span class=o>{</span>
      ...
      passenger_root /usr/local/passenger/passenger-5.2.3<span class=p>;</span>
      passenger_ruby /usr/local/ruby-2.4.3/bin/ruby<span class=p>;</span>
      ...
  <span class=o>}</span>

After you start Nginx, you are ready to deploy any number of Ruby on Rails
applications on Nginx.

Press ENTER to <span class=k>continue</span>.
</code></pre></td></tr></table></div></div><h2 id=開啟-nginx>開啟 Nginx</h2><p>不過到目前為止，我們其實只是把 Passenger 和 Nginx 編譯完成，但是並沒有把 Nginx 打開。也因此，其他人是無法連上這台伺服器上的網站。</p><p>為了方便管理，我們可以使用 <code>systemd</code> 功能，透過撰寫設定檔，來使用 <code>systemctl</code> 指令觀看狀態，或者重新啟動。</p><p>在 Nginx 官網有提供一份<a href=https://www.nginx.com/resources/wiki/start/topics/examples/systemd/>範例</a>，基本上只要修改範例上的路徑到正確的位置，我們就可以使用 <code>systemctl</code> 來控制 Nginx 的開啟跟關閉。</p><p>透過 <code>vi</code> 編輯 <code>/lib/systemd/system/nginx.service</code> 這個檔案。</p><pre><code>vi /lib/systemd/system/nginx.service
</code></pre><p>然後把下面的內容貼上，如果有修改 Nginx 的安裝路徑，要把 <code>/opt/nginx</code> 替換掉。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ini data-lang=ini><span class=k>[Unit]</span>
<span class=na>Description</span><span class=o>=</span><span class=s>The NGINX HTTP and reverse proxy server</span>
<span class=na>After</span><span class=o>=</span><span class=s>syslog.target network.target remote-fs.target nss-lookup.target</span>

<span class=k>[Service]</span>
<span class=na>Type</span><span class=o>=</span><span class=s>forking</span>
<span class=na>PIDFile</span><span class=o>=</span><span class=s>/opt/nginx/logs/nginx.pid</span>
<span class=na>ExecStartPre</span><span class=o>=</span><span class=s>/opt/nginx/sbin/nginx -t</span>
<span class=na>ExecStart</span><span class=o>=</span><span class=s>/opt/nginx/sbin/nginx</span>
<span class=na>ExecReload</span><span class=o>=</span><span class=s>/bin/kill -s HUP $MAINPID</span>
<span class=na>ExecStop</span><span class=o>=</span><span class=s>/bin/kill -s QUIT $MAINPID</span>
<span class=na>PrivateTmp</span><span class=o>=</span><span class=s>true</span>

<span class=k>[Install]</span>
<span class=na>WantedBy</span><span class=o>=</span><span class=s>multi-user.target</span>
</code></pre></td></tr></table></div></div><blockquote><p>還記得怎麼編輯嗎？按下 <code>i</code> 進入插入模式，貼上後用 <code>Esc</code> 退出，然後用 <code>:wq</code> 指令存檔離開。</p></blockquote><p>完成之後，我們就可以用 <code>systemctl</code> 指令來開啟或者關閉 Nginx 了，不過在這之前我們會希望在意外當機後重開機時，能夠自動地把 Nginx 啟動。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>systemctl <span class=nb>enable</span> nginx
</code></pre></td></tr></table></div></div><p>利用 <code>enable</code> 功能，把 Nginx 設定為開機自動啟動的項目。</p><p>接下來用 <code>start</code> 指令把 Nginx 打開，並且用 <code>status</code> 指令看看是不是變成 <code>running</code> 的運行狀態。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>systemctl start nginx
systemctl status nginx
</code></pre></td></tr></table></div></div><p>如果想檢查看看能不能連上，可以利用 <code>curl</code> 指令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>curl localhost
</code></pre></td></tr></table></div></div><p>如果有 HTML 語法出現，基本上就是安裝成功了！</p><blockquote><p>如果找不到 <code>curl</code> 指令可以執行，嘗試看看自己用 <code>yum</code> 安裝吧！</p></blockquote><h2 id=小結>小結</h2><p>其實文章到這邊，安裝伺服器的部分就告一段落。下一階段會介紹怎麼設定 Ruby on Rails 專案，用 Capistrano 這個 Gem 幫助你把網站部署到這台伺服器。</p><p>不過，伺服器的設定其實還沒有完成，只是這些小問題會讓你在維護上不太方便。在後面的教學中，會陸續介紹跟提供解決的方案。</p><footer class=article__footer><div class=text-center><div class=fb-share-button data-href="<%- page.permalink %>" data-layout=button_count></div></div><div class="text-center mt-1"><style>.bmc-button img{width:27px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{line-height:36px!important;height:37px!important;text-decoration:none!important;display:inline-flex!important;color:#fff!important;background-color:#000!important;border-radius:3px!important;border:1px solid transparent!important;padding:1px 9px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#fff!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/aotoki><img src=https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg alt="Buy me a Coffee"><span style=margin-left:5px>Buy me a Coffee</span></a></div><iframe scrolling=no frameborder=0 style="display:block;margin:0 auto;height:212px" src="https://button.like.co/in/embed/elct9620/button?referrer=<%- page.permalink %>"></iframe><ul class=article__tag-list><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/tags/%E6%95%99%E5%AD%B8/>教學</a></li><li class=article__tag-list-item><a class=article__tag-list-link href=https://blog.frost.tw/tags/DevOps/>DevOps</a></li></ul></footer></div></article><div class=adv><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-2844969736316510 data-ad-slot=5530952976 data-ad-format=auto></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><section id=comment class=comment-box><h1 class=comment-box__title>留言</h1><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"revo-skill-frost"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer id=footer><div id=copyright>&copy;2020 <a href="https://plus.google.com/117236344655673213049?rel=author" target=_blank>蒼時弦也</a>. All right reversed.</div></footer><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5TQLRN" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5TQLRN');</script><script>window.fbAsyncInit=function(){FB.init({appId:'178355449110',xfbml:true,version:'v2.12'});FB.AppEvents.logPageView();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="https://connect.facebook.net/zh_TW/sdk.js";js.async=true
fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><script src=/js/app.min.fd0f63ba3b20398c6e27ff59f1aa04d04afe06105c17ff6f6154ab0d4839bd38.js></script><div class=loading></div></body></html>